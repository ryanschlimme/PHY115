import numpy as np
import statistics
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

single_f = [
    0.15965939329430548,
    0.31931878658861096,
    0.47897817988291647,
    0.6386375731772219,
    0.7982969664715274,
    0.9579563597658328,
    1.1176157530601383,
    1.2772751463544438,
    1.4369345396487494,
    1.596593932943055,
    1.7562533262373605,
    1.915912719531666,
    2.0755721128259714,
    2.235231506120277,
    2.3948908994145826,
    2.554550292708888,
    2.7142096860031937,
    2.8738690792974992,
    3.033528472591805,
    3.1931878658861104,
    3.352847259180416,
    3.5125066524747215,
    3.672166045769027,
    3.8318254390633326,
    3.991484832357638,
    4.151144225651944,
    4.310803618946249,
    4.470463012240554,
    4.630122405534859,
    4.789781798829164,
    4.949441192123469,
    5.1091005854177745,
    5.26875997871208,
    5.428419372006385,
    5.58807876530069,
    5.747738158594995,
    5.9073975518893,
    6.067056945183605,
    6.22671633847791,
    6.386375731772215,
    6.5460351250665205,
    6.705694518360826,
    6.865353911655131,
    7.025013304949436,
    7.184672698243741,
    7.344332091538046,
    7.503991484832351,
    7.663650878126656,
    7.8233102714209615,
    7.982969664715267,
    8.142629058009572,
    8.302288451303877,
    8.461947844598182,
    8.621607237892487,
    8.781266631186792,
    8.940926024481097,
    9.100585417775402,
    9.260244811069708,
    9.419904204364013,
    9.579563597658318,
    9.739222990952623,
    9.898882384246928,
    10.058541777541233,
    10.218201170835538,
    10.377860564129843,
    10.537519957424148,
    10.697179350718454,
    10.856838744012759,
    11.016498137307064,
    11.176157530601369,
    11.335816923895674,
    11.49547631718998,
    11.655135710484284,
    11.81479510377859,
    11.974454497072895,
    12.1341138903672,
    12.293773283661505,
    12.45343267695581,
    12.613092070250115,
    12.77275146354442,
    12.932410856838725,
    13.09207025013303,
    13.251729643427336,
    13.41138903672164,
    13.571048430015946,
    13.73070782331025,
    13.890367216604556,
    14.050026609898861,
    14.209686003193166,
    14.369345396487471,
    14.529004789781776,
    14.688664183076082,
    14.848323576370387,
    15.007982969664692,
    15.167642362958997,
    15.327301756253302,
    15.486961149547607
]
single_power = [
    0.878681357749833,
    1.044627677350812,
    1.475139565564162,
    0.6886009147726339,
    0.8301424508505307,
    0.9214061819381135,
    1.264880959081525,
    2.3366220114347316,
    2.6011799909845674,
    5.3674848059424765,
    7.195402744719395,
    32.27250981951221,
    7854.492726496055,
    28.75708525420311,
    7.514305077911254,
    2.7793554707921935,
    1.7958484008772762,
    1.2300094222803004,
    0.7879531845940835,
    0.5584952838278502,
    0.5265139950837099,
    0.3971000583422657,
    0.5486331838428461,
    0.23202243029574826,
    0.1479193010296892,
    0.15909964173848662,
    0.13971094921098837,
    0.1086340737950876,
    0.10716053772468274,
    0.09578449334960631,
    0.07409231793570001,
    0.0627954405367867,
    0.06184423252661006,
    0.06676779522597595,
    0.05167951436301708,
    0.05477120892713435,
    0.0503062484341303,
    0.037630211200936244,
    0.09323330888144002,
    0.03551573337075331,
    0.030394033456941444,
    0.02855479658013337,
    0.032833218222645885,
    0.028574783036048483,
    0.028534477967756672,
    0.0278079653164258,
    0.022118172242798526,
    0.0249767737349511,
    0.02706306713231023,
    0.019323835823752866,
    0.026287342693987952,
    0.02567261874628665,
    0.025292370462085982,
    0.02199160889441662,
    0.018828413798788995,
    0.01308711317468688,
    0.017284805531785782,
    0.018808145902913364,
    0.018807881886312286,
    0.014469761251895972,
    0.012449907211551828,
    0.012831913873643734,
    0.012732925905501494,
    0.013253851874435799,
    0.011864799018373434,
    0.014206545166459148,
    0.011500542688473014,
    0.01279711389603377,
    0.016017031279517042,
    0.011475290506606353,
    0.009692222646301304,
    0.012330223078112058,
    0.008735583183168293,
    0.010930733181923084,
    0.012059776096782642,
    0.012981818130308331,
    0.010784664865063024,
    0.008424085528429368,
    0.01044274303757544,
    0.009216698679414687,
    0.010035154470374544,
    0.00867480848002321,
    0.011655309279314713,
    0.00965368743404219,
    0.009776426725419939,
    0.010530609824610411,
    0.011438732261482556,
    0.006810864542207737,
    0.008297301192353598,
    0.011361551736613438,
    0.0066317396875998184,
    0.011796442168383046,
    0.0076627682659013135,
    0.011077727315134447,
    0.010135951413690301,
    0.009448849283685596,
    0.009382803966545302
]
coupled_f_low = [
    0.7813630444219357,
    0.8681811604688174,
    0.9549992765156992,
    1.0418173925625809,
    1.1286355086094626,
    1.2154536246563443,
    1.302271740703226,
    1.3890898567501078,
    1.4759079727969895,
    1.5627260888438712,
    1.649544204890753,
    1.7363623209376347,
    1.8231804369845164
]
coupled_power_low = [
    6.140207756620793,
    31.510853686879095,
    21.67133777408799,
    12.34299566030403,
    22.137954271960396,
    63.743476472769785,
    2023.7791966488799,
    130.75675697500208,
    24.979277228794054,
    10.117800763908368,
    4.874875021845668,
    3.973796382320153,
    1.2844423205861157
]
coupled_f_high = [
    2.6913615974533354,
    2.7781797135002173,
    2.8649978295470993,
    2.951815945593981,
    3.038634061640863,
    3.125452177687745,
    3.212270293734627,
    3.299088409781509,
    3.385906525828391,
    3.472724641875273,
    3.559542757922155
]
coupled_power_high = [
    1.5500124126762806,
    2.1352524674596856,
    2.9111768854083775,
    5.940612762833021,
    25.556339727841923,
    1260.2720694711325,
    20.809282772711917,
    5.230146831315965,
    2.593091851716734,
    1.651946657752568,
    1.2013958875963051
]
neg_1_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866
]
neg_1_power = [
    0.010303315390411481,
    0.05529982285253509,
    0.12284013782323516,
    0.27495873581158536,
    0.8311894093082751,
    94.20166469743313,
    0.5599160861055894,
    0.158067932105844,
    0.037439704196336146,
    0.024489624615224963,
    0.019489182566131417,
    0.06997865410460163,
    0.015166532247857897,
    0.007323213964548959,
    0.010192307907894257,
    0.0053142204364432,
    0.011666615630939788,
    0.0016188452805883657,
    0.0023464988801678395,
    0.005051981661688793,
    0.00284704744856174,
    0.0021525608816038364,
    0.0037456259287726792,
    4.4015472887663857E-4,
    0.0016669437860837046,
    0.0038123473442570784,
    0.00291509970706768,
    0.001075936087745678,
    0.0027236624856843772,
    0.0010762804460848396,
    0.0011113711592479762,
    0.0010465904445794377,
    0.0017617203586778058,
    0.001684839746061274,
    0.0010574010091603733,
    9.429496513404267E-5,
    6.531348969552898E-4,
    1.5568291051261222E-4,
    0.0022548864727152135,
    0.0010861145411689291,
    1.786007023294125E-4,
    9.029653647000362E-4,
    5.048134033888397E-4,
    0.0010645551038284589,
    0.0019640318431870247,
    5.853054424766633E-4,
    8.39161859690618E-4,
    0.0010334669044953049,
    7.256341783421664E-4,
    9.795501848145693E-4,
    7.531757196345257E-4,
    0.001191627355011003,
    1.565385325701836E-4,
    7.654633074472546E-4,
    5.978792664779878E-4,
    3.534674940035756E-4,
    5.291455648971932E-4,
    3.51068970158085E-4,
    9.461243247149958E-4,
    1.670451658047932E-4,
    4.8440358395537126E-4,
    0.0015507396832024985,
    7.775709683566555E-4,
    3.0726669183969913E-4,
    0.0013402213277182468,
    3.204038466330316E-4,
    4.20072844125973E-4,
    3.9905950870901133E-4,
    2.930503814349232E-4,
    7.344620101568134E-4,
    1.5703835535487194E-4,
    1.4218156592624945E-4,
    8.980039201578686E-4,
    3.291430565810924E-4,
    6.984115817959676E-4,
    6.959967851516797E-4,
    3.1463741268729204E-4,
    3.968884692358081E-4,
    4.5733330155654995E-4,
    7.43699839056948E-4,
    9.889865008115536E-5,
    3.5359104640490606E-4,
    3.1651065548102654E-4,
    2.472439320095653E-4,
    1.5932568106502494E-4,
    4.569327351515133E-4,
    1.411386893541751E-4,
    1.2916082584206277E-4,
    6.957750422493583E-4,
    3.5349291512645455E-4,
    2.021444409033588E-5,
    3.2752380785464774E-4,
    3.4743035950326843E-4,
    7.712495935003798E-4,
    3.51566837956269E-5,
    5.175935520063729E-5,
    4.173286608473983E-4,
]
neg_2_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866,
    21.350762527233144,
]
neg_2_power = [
    0.33680846647006085,
    0.0320016287929652,
    0.16886965690235137,
    0.36306883481558194,
    1.678660796031761,
    221.54870289261572,
    1.5029360807525591,
    0.4221422318291988,
    0.20131814116873403,
    0.0963107411389562,
    0.07006707710847994,
    0.0756175955017542,
    0.04721348529007216,
    0.038340489203574954,
    0.0328394102735561,
    0.034818299487255545,
    0.014191024419613908,
    0.03485410261932712,
    0.01826812291715136,
    0.015749476503731572,
    0.017936879586923717,
    0.013300116238139294,
    0.006481651448153202,
    0.012327876673778814,
    0.009061237029847607,
    0.011667885739652488,
    0.009166389273955399,
    0.012229213906894154,
    0.0053963927221471275,
    0.009350421061439344,
    0.004304985361257703,
    0.005152624537482648,
    0.003918778210544101,
    0.005777024398345626,
    0.00486996815355621,
    0.001968153427716933,
    0.004742991486326304,
    0.001788365192972825,
    0.0027684119372101716,
    0.00497325088468295,
    0.0043255129348272825,
    0.006287655458750993,
    0.0013803487892540016,
    0.005728301924839589,
    0.0013590519198604049,
    0.0013764529687292201,
    0.004224544744552951,
    0.0017435617777237147,
    0.0015571944308990161,
    0.0013479756517717806,
    0.0011265420362854914,
    1.841751817694878E-4,
    8.809572166000872E-4,
    0.0017111543546273838,
    0.0030829642629232414,
    0.002104641106478751,
    0.003518844574187003,
    8.31033092714855E-4,
    0.0012400910604233207,
    7.368947229556557E-4,
    7.622298262909376E-5,
    7.744559019675305E-4,
    0.002359328192960167,
    1.1282398324173224E-4,
    0.002121728867514919,
    2.995507259917847E-4,
    7.831799109847608E-5,
    5.290229251348818E-4,
    3.8363145110136443E-4,
    7.431285752600488E-4,
    0.0012182511903583554,
    0.0016818367255426712,
    0.001326110046969363,
    0.0022203255790925404,
    4.6407334821935454E-5,
    6.331519075195421E-4,
    5.11170307421546E-4,
    5.8883052413357134E-5,
    7.391688110083145E-4,
    5.463464709228587E-4,
    0.0014471020794103063,
    0.001226376190714669,
    0.001153921216137617,
    7.106466432884586E-4,
    9.738775241234605E-4,
    5.727151079139703E-4,
    2.465413156431274E-4,
    0.0011769951294250747,
    9.962620347219375E-4,
    2.790491596612092E-4,
    0.0015268021380480331,
    0.001108417607166952,
    3.666902374179653E-5,
    9.47327905352853E-4,
    7.014279429444985E-5,
    0.0023647675887814783,
    1.3514451652387558E-4,
    4.4415201985677395E-4
]
pos_1_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866,
    21.350762527233144
]
pos_1_power = [
    0.08329154039327888,
    0.0320163604282607,
    0.01249537495956855,
    0.010658518903595924,
    0.00502466746854987,
    0.006875528958691286,
    0.020716871267209152,
    0.025847675268175593,
    0.04003500885972101,
    0.03519686660870831,
    0.06993816918401918,
    0.14961916075585202,
    0.4030355469559075,
    3.5034118077716156,
    3.980111310432394,
    0.4233929589895016,
    0.15043196425078542,
    0.08005733248578377,
    0.06856214224571984,
    0.033794380379777306,
    0.02328567845491422,
    0.014027977365484407,
    0.014383651615839925,
    0.008587525682732921,
    0.014145183989099372,
    0.014581975819671265,
    0.011116564572959255,
    0.00985862711393683,
    0.004460352961715612,
    0.006465565650969004,
    0.004121952478219329,
    0.004145599791688376,
    0.004706323925213785,
    0.0012142879210706706,
    0.005640497794855405,
    0.0018223434652201006,
    0.0016853599031390713,
    0.004244842222198469,
    0.004673787424996286,
    0.0025298690360492527,
    0.0029289705355977423,
    0.0022235146872702227,
    0.0024236850399267573,
    0.004160970777099867,
    0.003002137614200972,
    0.0026941140877204768,
    0.002168924878515501,
    0.0028874916883809337,
    0.002715409554279938,
    0.0013309068359012243,
    0.0011908887472115758,
    0.002660618019155371,
    9.326984838761354E-4,
    0.0025900016478857535,
    0.002302302490142692,
    0.0027383126741882396,
    6.69170562978538E-4,
    0.003695366608010152,
    0.0011633220603983311,
    2.4239672226969818E-4,
    5.639886384865867E-4,
    0.001359757068394219,
    0.002288739849048321,
    8.095000006494873E-4,
    0.0016859283488037343,
    6.82235760221669E-4,
    0.0014250969575610463,
    0.0017539365361822156,
    3.71298105198101E-4,
    5.131360643850495E-4,
    3.9547845654430176E-4,
    3.3994740589152054E-4,
    7.934378290733496E-4,
    0.0015533425149666777,
    6.374569511892634E-4,
    0.0010390354797394702,
    3.7963047107614743E-4,
    0.0011221352659088518,
    4.4854829263158585E-4,
    8.305458170201596E-4,
    5.993302023226094E-4,
    0.002456018235717269,
    7.816495534765844E-4,
    0.0012410599831702669,
    0.0017590118185698456,
    6.883055754380164E-4,
    0.0016055224041691858,
    6.070341195765688E-4,
    0.0011118580356375253,
    8.421510837673287E-4,
    6.445546463080919E-4,
    0.001295376445911463,
    3.425452343411188E-4,
    2.2184520967905502E-4,
    2.4863853088088025E-4,
    7.02826554767122E-4,
    8.992118785724096E-4,
    3.810833956332812E-4,
]
pos_2_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866,
    21.350762527233144,
]
pos_2_power = [
    0.006284120242329552,
    0.014125066193755292,
    0.01012275601495977,
    0.0054479858898157174,
    0.008769370597791733,
    0.003155239641252993,
    0.00905110718011159,
    6.22903879003141E-4,
    0.01895379833425173,
    0.01981503032890901,
    0.012102121652149116,
    0.03019645781435156,
    0.23584264305987127,
    1.7668077200719674,
    1.971402630524318,
    0.23666989808954944,
    0.07388690932479806,
    0.029953696696633933,
    0.03544736832482914,
    0.016957097538302116,
    0.018282378770570266,
    0.014737757352911674,
    0.01136468198524983,
    0.00919000765470551,
    0.008955099881930127,
    0.0037157886468017626,
    0.006343632561460869,
    0.005540549398103886,
    0.005071618412837915,
    0.0038467871966236574,
    0.003369503584754495,
    0.004348656571581184,
    0.0027578565217709575,
    0.00264629107608223,
    0.0023070425944597874,
    0.003187397507350666,
    0.001086418588799885,
    0.0017319767216507822,
    0.0016295946625202403,
    0.00128267706199616,
    5.313161049720675E-4,
    0.004946851645703427,
    5.306820258059659E-4,
    0.0013655678103924951,
    0.00322244638011923,
    0.0016568163806980653,
    0.001106475772219953,
    7.503291772044296E-4,
    9.593323134095157E-4,
    0.0024257862034197516,
    3.11283806643834E-4,
    0.0012947243557800458,
    7.316502220871572E-4,
    3.809447003526548E-4,
    0.0010781177946770641,
    4.2121991903901993E-4,
    0.001537982042555163,
    7.021272638247472E-4,
    0.0012774892542110452,
    9.99856725059371E-4,
    7.251999984466507E-4,
    8.140823413632362E-4,
    7.071024543852441E-4,
    4.8594188933614036E-4,
    2.460099045161977E-4,
    8.836034716662676E-4,
    0.0017278371254072287,
    0.0016756418755074164,
    2.39586405253189E-4,
    6.089668649467038E-4,
    0.0016631177732024762,
    0.0014012462808073562,
    3.767783323518396E-4,
    2.3085556898874116E-4,
    6.630681915430586E-4,
    5.70968824182832E-4,
    7.633962953174981E-5,
    4.4013521282414034E-4,
    2.2427445084196852E-4,
    4.3999553974985884E-4,
    1.2805517760894558E-4,
    2.2318028481275903E-4,
    1.7265961067642504E-4,
    7.390444817762141E-4,
    4.230680685125483E-4,
    4.876236608933319E-4,
    8.001082957232865E-4,
    4.023597247400165E-4,
    7.150077747757917E-4,
    7.568570065261363E-4,
    4.596898152172547E-4,
    6.135342219996572E-4,
    1.1150454685175975E-4,
    2.913108865930616E-4,
    3.0002841600298416E-4,
    5.855382679413928E-4,
    0.001274655039412658,
    2.3387602248449153E-4
]


def fp(f, p):
    a = (f * p)
    return a


# Observed Values
weight_single_numerator = list(map(fp, single_f, single_power))
weight_single = round(sum(weight_single_numerator) / sum(single_power), 3)
weight_single_angular = round(weight_single * 2 * np.pi, 3)

print("Single Oscillator Statistics")
print("The weighted average frequency of the single oscillator is", weight_single, "Hz")
print("Therefore the weighted average angular frequency is", weight_single_angular, "rad/s")

weight_coupled_numerator_low = list(map(fp, coupled_f_low, coupled_power_low))
weight_coupled_low = round(sum(weight_coupled_numerator_low) / sum(coupled_power_low), 3)
weight_coupled_low_angular = round(weight_coupled_low * 2 * np.pi, 3)
weight_coupled_numerator_high = list(map(fp, coupled_f_high, coupled_power_high))
weight_coupled_high = round(sum(weight_coupled_numerator_high) / sum(coupled_power_high), 3)
weight_coupled_high_angular = round(weight_coupled_high * 2 * np.pi, 3)

print()
print("Coupled Oscillator Statistics")
print("The lower weighted average frequency of the coupled oscillator is", weight_coupled_low, "Hz")
print("Therefore the lower weighted average angular frequency is", weight_coupled_low_angular, "rad/s")
print("The higher weighted average frequency of the coupled oscillator is", weight_coupled_high, "Hz")
print("Therefore the higher weighted average angular frequency is", weight_coupled_high_angular, "rad/s")

weight_neg_1_numerator = list(map(fp, neg_1_f, neg_1_power))
weight_neg_1 = round(sum(weight_neg_1_numerator) / sum(neg_1_power), 3)
weight_neg_1_angular = round(weight_neg_1 * 2 * np.pi, 3)

print()
print("Omega Minus 1st Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 1st mass is", weight_neg_1, "Hz")
print("Therefore the weighted average angular frequency is", weight_neg_1_angular, "rad/s")

weight_neg_2_numerator = list(map(fp, neg_2_f, neg_2_power))
weight_neg_2 = round(sum(weight_neg_2_numerator) / sum(neg_2_power), 3)
weight_neg_2_angular = round(weight_neg_2 * 2 * np.pi, 3)

print()
print("Omega Minus 2nd Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 2nd mass is", weight_neg_2, "Hz")
print("Therefore the weighted average angular frequency is", weight_neg_2_angular, "rad/s")

weight_pos_1_numerator = list(map(fp, pos_1_f, pos_1_power))
weight_pos_1 = round(sum(weight_pos_1_numerator) / sum(pos_1_power), 3)
weight_pos_1_angular = round(weight_pos_1 * 2 * np.pi, 3)

print()
print("Omega Plus 1st Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 1st mass is", weight_pos_1, "Hz")
print("Therefore the weighted average angular frequency is", weight_pos_1_angular, "rad/s")

weight_pos_2_numerator = list(map(fp, pos_2_f, pos_2_power))
weight_pos_2 = round(sum(weight_pos_2_numerator) / sum(pos_2_power), 3)
weight_pos_2_angular = round(weight_pos_2 * 2 * np.pi, 3)

print()
print("Omega Plus 2nd Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 2nd mass is", weight_pos_2, "Hz")
print("Therefore the weighted average angular frequency is", weight_pos_2_angular, "rad/s")

# Expected Values
k1 = 23.98
k2 = 17.36
m1 = 0.131
m2 = 0.108
wplus = (1 / np.sqrt(2)) * np.sqrt(
    (k2 / m2) + (k1 + k2) / m1 + np.sqrt((k2 / m2 + (k1 + k2) / m1) ** 2 - 4*(k2 * (k1 + k2) - k2 ** 2) / (m1 * m2)))

wminus = (1 / np.sqrt(2)) * np.sqrt(
    (k2 / m2) + (k1 + k2) / m1 - np.sqrt((k2 / m2 + (k1 + k2) / m1) ** 2 - 4*(k2 * (k1 + k2) - k2 ** 2) / (m1 * m2)))

print()
print("The theoretical angular frequencies of the coupled oscillator are", round(wplus, 3), "rad/s and",
      round(wminus, 3), "rad/s")
