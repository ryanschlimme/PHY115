import numpy as np
import statistics
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

single_f = [
    0.15965939329430548,
    0.31931878658861096,
    0.47897817988291647,
    0.6386375731772219,
    0.7982969664715274,
    0.9579563597658328,
    1.1176157530601383,
    1.2772751463544438,
    1.4369345396487494,
    1.596593932943055,
    1.7562533262373605,
    1.915912719531666,
    2.0755721128259714,
    2.235231506120277,
    2.3948908994145826,
    2.554550292708888,
    2.7142096860031937,
    2.8738690792974992,
    3.033528472591805,
    3.1931878658861104,
    3.352847259180416,
    3.5125066524747215,
    3.672166045769027,
    3.8318254390633326,
    3.991484832357638,
    4.151144225651944,
    4.310803618946249,
    4.470463012240554,
    4.630122405534859,
    4.789781798829164,
    4.949441192123469,
    5.1091005854177745,
    5.26875997871208,
    5.428419372006385,
    5.58807876530069,
    5.747738158594995,
    5.9073975518893,
    6.067056945183605,
    6.22671633847791,
    6.386375731772215,
    6.5460351250665205,
    6.705694518360826,
    6.865353911655131,
    7.025013304949436,
    7.184672698243741,
    7.344332091538046,
    7.503991484832351,
    7.663650878126656,
    7.8233102714209615,
    7.982969664715267,
    8.142629058009572,
    8.302288451303877,
    8.461947844598182,
    8.621607237892487,
    8.781266631186792,
    8.940926024481097,
    9.100585417775402,
    9.260244811069708,
    9.419904204364013,
    9.579563597658318,
    9.739222990952623,
    9.898882384246928,
    10.058541777541233,
    10.218201170835538,
    10.377860564129843,
    10.537519957424148,
    10.697179350718454,
    10.856838744012759,
    11.016498137307064,
    11.176157530601369,
    11.335816923895674,
    11.49547631718998,
    11.655135710484284,
    11.81479510377859,
    11.974454497072895,
    12.1341138903672,
    12.293773283661505,
    12.45343267695581,
    12.613092070250115,
    12.77275146354442,
    12.932410856838725,
    13.09207025013303,
    13.251729643427336,
    13.41138903672164,
    13.571048430015946,
    13.73070782331025,
    13.890367216604556,
    14.050026609898861,
    14.209686003193166,
    14.369345396487471,
    14.529004789781776,
    14.688664183076082,
    14.848323576370387,
    15.007982969664692,
    15.167642362958997,
    15.327301756253302,
    15.486961149547607
]
single_power = [
    0.878681357749833,
    1.044627677350812,
    1.475139565564162,
    0.6886009147726339,
    0.8301424508505307,
    0.9214061819381135,
    1.264880959081525,
    2.3366220114347316,
    2.6011799909845674,
    5.3674848059424765,
    7.195402744719395,
    32.27250981951221,
    7854.492726496055,
    28.75708525420311,
    7.514305077911254,
    2.7793554707921935,
    1.7958484008772762,
    1.2300094222803004,
    0.7879531845940835,
    0.5584952838278502,
    0.5265139950837099,
    0.3971000583422657,
    0.5486331838428461,
    0.23202243029574826,
    0.1479193010296892,
    0.15909964173848662,
    0.13971094921098837,
    0.1086340737950876,
    0.10716053772468274,
    0.09578449334960631,
    0.07409231793570001,
    0.0627954405367867,
    0.06184423252661006,
    0.06676779522597595,
    0.05167951436301708,
    0.05477120892713435,
    0.0503062484341303,
    0.037630211200936244,
    0.09323330888144002,
    0.03551573337075331,
    0.030394033456941444,
    0.02855479658013337,
    0.032833218222645885,
    0.028574783036048483,
    0.028534477967756672,
    0.0278079653164258,
    0.022118172242798526,
    0.0249767737349511,
    0.02706306713231023,
    0.019323835823752866,
    0.026287342693987952,
    0.02567261874628665,
    0.025292370462085982,
    0.02199160889441662,
    0.018828413798788995,
    0.01308711317468688,
    0.017284805531785782,
    0.018808145902913364,
    0.018807881886312286,
    0.014469761251895972,
    0.012449907211551828,
    0.012831913873643734,
    0.012732925905501494,
    0.013253851874435799,
    0.011864799018373434,
    0.014206545166459148,
    0.011500542688473014,
    0.01279711389603377,
    0.016017031279517042,
    0.011475290506606353,
    0.009692222646301304,
    0.012330223078112058,
    0.008735583183168293,
    0.010930733181923084,
    0.012059776096782642,
    0.012981818130308331,
    0.010784664865063024,
    0.008424085528429368,
    0.01044274303757544,
    0.009216698679414687,
    0.010035154470374544,
    0.00867480848002321,
    0.011655309279314713,
    0.00965368743404219,
    0.009776426725419939,
    0.010530609824610411,
    0.011438732261482556,
    0.006810864542207737,
    0.008297301192353598,
    0.011361551736613438,
    0.0066317396875998184,
    0.011796442168383046,
    0.0076627682659013135,
    0.011077727315134447,
    0.010135951413690301,
    0.009448849283685596,
    0.009382803966545302
]
coupled_f = [
    0.08681811604688176,
    0.17363623209376353,
    0.2604543481406453,
    0.34727246418752705,
    0.43409058023440883,
    0.5209086962812906,
    0.6077268123281723,
    0.694544928375054,
    0.7813630444219357,
    0.8681811604688174,
    0.9549992765156992,
    1.0418173925625809,
    1.1286355086094626,
    1.2154536246563443,
    1.302271740703226,
    1.3890898567501078,
    1.4759079727969895,
    1.5627260888438712,
    1.649544204890753,
    1.7363623209376347,
    1.8231804369845164,
    1.909998553031398,
    1.9968166690782798,
    2.0836347851251618,
    2.1704529011720437,
    2.2572710172189256,
    2.3440891332658076,
    2.4309072493126895,
    2.5177253653595715,
    2.6045434814064534,
    2.6913615974533354,
    2.7781797135002173,
    2.8649978295470993,
    2.951815945593981,
    3.038634061640863,
    3.125452177687745,
    3.212270293734627,
    3.299088409781509,
    3.385906525828391,
    3.472724641875273,
    3.559542757922155,
    3.6463608739690367,
    3.7331789900159187,
    3.8199971060628006,
    3.9068152221096826,
    3.9936333381565645,
    4.0804514542034465,
    4.167269570250328,
    4.2540876862972095,
    4.340905802344091,
    4.4277239183909725,
    4.514542034437854,
    4.6013601504847355,
    4.688178266531617,
    4.7749963825784985,
    4.86181449862538,
    4.9486326146722615,
    5.035450730719143,
    5.1222688467660245,
    5.209086962812906,
    5.2959050788597875,
    5.382723194906669,
    5.4695413109535505,
    5.556359427000432,
    5.6431775430473134,
    5.729995659094195,
    5.8168137751410764,
    5.903631891187958,
    5.9904500072348394,
    6.077268123281721,
    6.1640862393286024,
    6.250904355375484,
    6.3377224714223654,
    6.424540587469247,
    6.511358703516128,
    6.59817681956301,
    6.684994935609891,
    6.771813051656773,
    6.858631167703654,
    6.945449283750536,
    7.032267399797417,
    7.119085515844299,
    7.20590363189118,
    7.292721747938062,
    7.379539863984943,
    7.466357980031825,
    7.553176096078706,
    7.639994212125588,
    7.726812328172469,
    7.813630444219351,
    7.900448560266232,
    7.987266676313114,
    8.074084792359995,
    8.160902908406877,
    8.247721024453758,
    8.33453914050064,
    8.421357256547521,
    8.508175372594403,
    8.594993488641284,
    8.681811604688166,
    8.768629720735047,
    8.855447836781929,
    8.94226595282881,
    9.029084068875692,
    9.115902184922573,
    9.202720300969455,
    9.289538417016336,
    9.376356533063218,
    9.4631746491101,
    9.549992765156981,
    9.636810881203862,
    9.723628997250744,
    9.810447113297625,
    9.897265229344507,
    9.984083345391388,
    10.07090146143827,
    10.157719577485151,
    10.244537693532033,
    10.331355809578914,
    10.418173925625796,
    10.504992041672677,
    10.591810157719559,
    10.67862827376644,
    10.765446389813322,
    10.852264505860203,
    10.939082621907085,
    11.025900737953966,
    11.112718854000848,
    11.19953697004773,
    11.286355086094611,
    11.373173202141492,
    11.459991318188374,
    11.546809434235255,
    11.633627550282137,
    11.720445666329018,
    11.8072637823759,
    11.894081898422781,
    11.980900014469663,
    12.067718130516544,
    12.154536246563426,
    12.241354362610307,
    12.328172478657189,
    12.41499059470407,
    12.501808710750952,
    12.588626826797833,
    12.675444942844715,
    12.762263058891596,
    12.849081174938478,
    12.93589929098536,
    13.022717407032241,
    13.109535523079122,
    13.196353639126004,
    13.283171755172885,
    13.369989871219767,
    13.456807987266648,
    13.54362610331353,
    13.630444219360411,
    13.717262335407293,
    13.804080451454174,
    13.890898567501056,
    13.977716683547937,
    14.064534799594819,
    14.1513529156417,
    14.238171031688582,
    14.324989147735463,
    14.411807263782345,
    14.498625379829226,
    14.585443495876108,
    14.67226161192299,
    14.75907972796987,
    14.845897844016752,
    14.932715960063634,
    15.019534076110515,
    15.106352192157397,
    15.193170308204278,
    15.27998842425116,
    15.366806540298041,
    15.453624656344923,
    15.540442772391804,
    15.627260888438686,
    15.714079004485567,
    15.800897120532449,
    15.88771523657933,
    15.974533352626212,
    16.061351468673095,
    16.148169584719977,
    16.234987700766858,
    16.32180581681374,
    16.40862393286062,
    16.495442048907503,
    16.582260164954384,
    16.669078281001266,
    16.755896397048147,
    16.84271451309503,
    16.92953262914191,
    17.01635074518879,
    17.103168861235673,
    17.189986977282555,
    17.276805093329436,
    17.363623209376318,
    17.4504413254232,
    17.53725944147008,
    17.624077557516962,
    17.710895673563844,
    17.797713789610725,
    17.884531905657607,
    17.971350021704488,
    18.05816813775137,
    18.14498625379825,
    18.231804369845133,
    18.318622485892014,
    18.405440601938896,
    18.492258717985777,
    18.57907683403266,
    18.66589495007954,
    18.75271306612642,
    18.839531182173303,
    18.926349298220185,
    19.013167414267066,
    19.099985530313948,
    19.18680364636083,
    19.27362176240771,
    19.360439878454592,
    19.447257994501474,
    19.534076110548355,
    19.620894226595237,
    19.707712342642118,
    19.794530458689,
    19.88134857473588,
    19.968166690782763,
    20.054984806829644,
    20.141802922876526,
    20.228621038923407,
    20.31543915497029,
    20.40225727101717,
    20.48907538706405,
    20.575893503110933,
    20.662711619157815,
    20.749529735204696,
    20.836347851251578,
    20.92316596729846,
    21.00998408334534,
    21.096802199392222,
    21.183620315439104,
    21.270438431485985,
    21.357256547532867,
    21.444074663579748,
    21.53089277962663,
    21.61771089567351
]
coupled_power = [
    0.863560978555751,
    0.4503420901707301,
    1.146223647477127,
    1.1329381767832847,
    2.4700390547302518,
    3.1479477688735242,
    2.8057506446843985,
    3.7385552777066424,
    6.140207756620793,
    31.510853686879095,
    21.67133777408799,
    12.34299566030403,
    22.137954271960396,
    63.743476472769785,
    2023.7791966488799,
    130.75675697500208,
    24.979277228794054,
    10.117800763908368,
    4.874875021845668,
    3.973796382320153,
    1.2844423205861157,
    0.9739249629236506,
    0.6483560557561199,
    0.4103653174835049,
    1.2214750469021967,
    2.5773675257433872,
    1.204827254172931,
    1.9690733000600917,
    1.398908673374391,
    0.7941291028637943,
    1.5500124126762806,
    2.1352524674596856,
    2.9111768854083775,
    5.940612762833021,
    25.556339727841923,
    1260.2720694711325,
    20.809282772711917,
    5.230146831315965,
    2.593091851716734,
    1.651946657752568,
    1.2013958875963051,
    1.0824965288272013,
    0.7489338665553167,
    0.6726768953254738,
    0.42269904951115667,
    0.14294706548364206,
    0.931893120171474,
    0.5192146995871963,
    0.4312288744475947,
    0.2852840304123083,
    0.45165987560446236,
    0.652696995443006,
    0.3780134213353559,
    0.3019755499062525,
    0.2770091929510968,
    0.21254402344176856,
    0.16987953692871724,
    0.17235740150933346,
    0.17029595176611126,
    0.16264340620575202,
    0.21120121360791172,
    0.06035355950172133,
    0.07750889998166695,
    0.0682035720933486,
    0.09554424917869937,
    0.08292008488491294,
    0.09878436374539447,
    0.10123227919295744,
    0.09970454582252754,
    0.09140675647104246,
    0.06178739510992922,
    0.0666568526308078,
    0.13632194009429105,
    0.11077962574358012,
    0.10490195260214329,
    0.09457755419601767,
    0.08985505388817333,
    0.07854794999143305,
    0.0680708671528845,
    0.06586906764587998,
    0.07105914537184911,
    0.060232429918726155,
    0.0535272692644006,
    0.060434254832471876,
    0.05475019732876386,
    0.056039127598214396,
    0.05315528632869364,
    0.04430753064107031,
    0.05059173474794694,
    0.05093621406054256,
    0.05028088536391247,
    0.0470730019653159,
    0.05167337534036559,
    0.052778443646190845,
    0.049758093905398024,
    0.04702878993682341,
    0.04412197435067623,
    0.04654360367035974,
    0.03823589021401198,
    0.052725193901737834,
    0.03738440194134325,
    0.040855696936729906,
    0.03304216356852775,
    0.03664986498545784,
    0.03372094937857949,
    0.03269638381701939,
    0.035694077144120234,
    0.03625347110631631,
    0.025950132655771237,
    0.0302354886301249,
    0.03158330550146489,
    0.03153774105980589,
    0.029576782862643602,
    0.032945672118693634,
    0.03364842772293114,
    0.03159947579389975,
    0.0312067931094808,
    0.032710147118059564,
    0.026069543590295667,
    0.027486846295129163,
    0.027969877536775704,
    0.028810987286272426,
    0.029115578807827537,
    0.023462633475809565,
    0.0261146525287193,
    0.02537448640656468,
    0.026945596764773976,
    0.02528802189808909,
    0.019780958610545237,
    0.02165384730506536,
    0.0224572267505065,
    0.025223142654803084,
    0.023663572066347338
]
neg_1_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866
]
neg_1_power = [
    0.010303315390411481,
    0.05529982285253509,
    0.12284013782323516,
    0.27495873581158536,
    0.8311894093082751,
    94.20166469743313,
    0.5599160861055894,
    0.158067932105844,
    0.037439704196336146,
    0.024489624615224963,
    0.019489182566131417,
    0.06997865410460163,
    0.015166532247857897,
    0.007323213964548959,
    0.010192307907894257,
    0.0053142204364432,
    0.011666615630939788,
    0.0016188452805883657,
    0.0023464988801678395,
    0.005051981661688793,
    0.00284704744856174,
    0.0021525608816038364,
    0.0037456259287726792,
    4.4015472887663857E-4,
    0.0016669437860837046,
    0.0038123473442570784,
    0.00291509970706768,
    0.001075936087745678,
    0.0027236624856843772,
    0.0010762804460848396,
    0.0011113711592479762,
    0.0010465904445794377,
    0.0017617203586778058,
    0.001684839746061274,
    0.0010574010091603733,
    9.429496513404267E-5,
    6.531348969552898E-4,
    1.5568291051261222E-4,
    0.0022548864727152135,
    0.0010861145411689291,
    1.786007023294125E-4,
    9.029653647000362E-4,
    5.048134033888397E-4,
    0.0010645551038284589,
    0.0019640318431870247,
    5.853054424766633E-4,
    8.39161859690618E-4,
    0.0010334669044953049,
    7.256341783421664E-4,
    9.795501848145693E-4,
    7.531757196345257E-4,
    0.001191627355011003,
    1.565385325701836E-4,
    7.654633074472546E-4,
    5.978792664779878E-4,
    3.534674940035756E-4,
    5.291455648971932E-4,
    3.51068970158085E-4,
    9.461243247149958E-4,
    1.670451658047932E-4,
    4.8440358395537126E-4,
    0.0015507396832024985,
    7.775709683566555E-4,
    3.0726669183969913E-4,
    0.0013402213277182468,
    3.204038466330316E-4,
    4.20072844125973E-4,
    3.9905950870901133E-4,
    2.930503814349232E-4,
    7.344620101568134E-4,
    1.5703835535487194E-4,
    1.4218156592624945E-4,
    8.980039201578686E-4,
    3.291430565810924E-4,
    6.984115817959676E-4,
    6.959967851516797E-4,
    3.1463741268729204E-4,
    3.968884692358081E-4,
    4.5733330155654995E-4,
    7.43699839056948E-4,
    9.889865008115536E-5,
    3.5359104640490606E-4,
    3.1651065548102654E-4,
    2.472439320095653E-4,
    1.5932568106502494E-4,
    4.569327351515133E-4,
    1.411386893541751E-4,
    1.2916082584206277E-4,
    6.957750422493583E-4,
    3.5349291512645455E-4,
    2.021444409033588E-5,
    3.2752380785464774E-4,
    3.4743035950326843E-4,
    7.712495935003798E-4,
    3.51566837956269E-5,
    5.175935520063729E-5,
    4.173286608473983E-4,
]
neg_2_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866,
    21.350762527233144,
]
neg_2_power = [
    0.33680846647006085,
    0.0320016287929652,
    0.16886965690235137,
    0.36306883481558194,
    1.678660796031761,
    221.54870289261572,
    1.5029360807525591,
    0.4221422318291988,
    0.20131814116873403,
    0.0963107411389562,
    0.07006707710847994,
    0.0756175955017542,
    0.04721348529007216,
    0.038340489203574954,
    0.0328394102735561,
    0.034818299487255545,
    0.014191024419613908,
    0.03485410261932712,
    0.01826812291715136,
    0.015749476503731572,
    0.017936879586923717,
    0.013300116238139294,
    0.006481651448153202,
    0.012327876673778814,
    0.009061237029847607,
    0.011667885739652488,
    0.009166389273955399,
    0.012229213906894154,
    0.0053963927221471275,
    0.009350421061439344,
    0.004304985361257703,
    0.005152624537482648,
    0.003918778210544101,
    0.005777024398345626,
    0.00486996815355621,
    0.001968153427716933,
    0.004742991486326304,
    0.001788365192972825,
    0.0027684119372101716,
    0.00497325088468295,
    0.0043255129348272825,
    0.006287655458750993,
    0.0013803487892540016,
    0.005728301924839589,
    0.0013590519198604049,
    0.0013764529687292201,
    0.004224544744552951,
    0.0017435617777237147,
    0.0015571944308990161,
    0.0013479756517717806,
    0.0011265420362854914,
    1.841751817694878E-4,
    8.809572166000872E-4,
    0.0017111543546273838,
    0.0030829642629232414,
    0.002104641106478751,
    0.003518844574187003,
    8.31033092714855E-4,
    0.0012400910604233207,
    7.368947229556557E-4,
    7.622298262909376E-5,
    7.744559019675305E-4,
    0.002359328192960167,
    1.1282398324173224E-4,
    0.002121728867514919,
    2.995507259917847E-4,
    7.831799109847608E-5,
    5.290229251348818E-4,
    3.8363145110136443E-4,
    7.431285752600488E-4,
    0.0012182511903583554,
    0.0016818367255426712,
    0.001326110046969363,
    0.0022203255790925404,
    4.6407334821935454E-5,
    6.331519075195421E-4,
    5.11170307421546E-4,
    5.8883052413357134E-5,
    7.391688110083145E-4,
    5.463464709228587E-4,
    0.0014471020794103063,
    0.001226376190714669,
    0.001153921216137617,
    7.106466432884586E-4,
    9.738775241234605E-4,
    5.727151079139703E-4,
    2.465413156431274E-4,
    0.0011769951294250747,
    9.962620347219375E-4,
    2.790491596612092E-4,
    0.0015268021380480331,
    0.001108417607166952,
    3.666902374179653E-5,
    9.47327905352853E-4,
    7.014279429444985E-5,
    0.0023647675887814783,
    1.3514451652387558E-4,
    4.4415201985677395E-4
]
pos_1_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866,
    21.350762527233144
]
pos_1_power = [
    0.08329154039327888,
    0.0320163604282607,
    0.01249537495956855,
    0.010658518903595924,
    0.00502466746854987,
    0.006875528958691286,
    0.020716871267209152,
    0.025847675268175593,
    0.04003500885972101,
    0.03519686660870831,
    0.06993816918401918,
    0.14961916075585202,
    0.4030355469559075,
    3.5034118077716156,
    3.980111310432394,
    0.4233929589895016,
    0.15043196425078542,
    0.08005733248578377,
    0.06856214224571984,
    0.033794380379777306,
    0.02328567845491422,
    0.014027977365484407,
    0.014383651615839925,
    0.008587525682732921,
    0.014145183989099372,
    0.014581975819671265,
    0.011116564572959255,
    0.00985862711393683,
    0.004460352961715612,
    0.006465565650969004,
    0.004121952478219329,
    0.004145599791688376,
    0.004706323925213785,
    0.0012142879210706706,
    0.005640497794855405,
    0.0018223434652201006,
    0.0016853599031390713,
    0.004244842222198469,
    0.004673787424996286,
    0.0025298690360492527,
    0.0029289705355977423,
    0.0022235146872702227,
    0.0024236850399267573,
    0.004160970777099867,
    0.003002137614200972,
    0.0026941140877204768,
    0.002168924878515501,
    0.0028874916883809337,
    0.002715409554279938,
    0.0013309068359012243,
    0.0011908887472115758,
    0.002660618019155371,
    9.326984838761354E-4,
    0.0025900016478857535,
    0.002302302490142692,
    0.0027383126741882396,
    6.69170562978538E-4,
    0.003695366608010152,
    0.0011633220603983311,
    2.4239672226969818E-4,
    5.639886384865867E-4,
    0.001359757068394219,
    0.002288739849048321,
    8.095000006494873E-4,
    0.0016859283488037343,
    6.82235760221669E-4,
    0.0014250969575610463,
    0.0017539365361822156,
    3.71298105198101E-4,
    5.131360643850495E-4,
    3.9547845654430176E-4,
    3.3994740589152054E-4,
    7.934378290733496E-4,
    0.0015533425149666777,
    6.374569511892634E-4,
    0.0010390354797394702,
    3.7963047107614743E-4,
    0.0011221352659088518,
    4.4854829263158585E-4,
    8.305458170201596E-4,
    5.993302023226094E-4,
    0.002456018235717269,
    7.816495534765844E-4,
    0.0012410599831702669,
    0.0017590118185698456,
    6.883055754380164E-4,
    0.0016055224041691858,
    6.070341195765688E-4,
    0.0011118580356375253,
    8.421510837673287E-4,
    6.445546463080919E-4,
    0.001295376445911463,
    3.425452343411188E-4,
    2.2184520967905502E-4,
    2.4863853088088025E-4,
    7.02826554767122E-4,
    8.992118785724096E-4,
    3.810833956332812E-4,
]
pos_2_f = [
    0.21786492374727667,
    0.43572984749455335,
    0.65359477124183,
    0.8714596949891067,
    1.0893246187363834,
    1.3071895424836601,
    1.5250544662309369,
    1.7429193899782136,
    1.9607843137254903,
    2.178649237472767,
    2.3965141612200433,
    2.61437908496732,
    2.8322440087145964,
    3.050108932461873,
    3.2679738562091494,
    3.485838779956426,
    3.7037037037037024,
    3.921568627450979,
    4.139433551198255,
    4.357298474945532,
    4.575163398692808,
    4.793028322440085,
    5.010893246187361,
    5.228758169934638,
    5.446623093681914,
    5.664488017429191,
    5.8823529411764675,
    6.100217864923744,
    6.3180827886710205,
    6.535947712418297,
    6.7538126361655735,
    6.97167755991285,
    7.1895424836601265,
    7.407407407407403,
    7.6252723311546795,
    7.843137254901956,
    8.061002178649233,
    8.278867102396509,
    8.496732026143786,
    8.714596949891062,
    8.932461873638339,
    9.150326797385615,
    9.368191721132892,
    9.586056644880168,
    9.803921568627445,
    10.021786492374721,
    10.239651416121998,
    10.457516339869274,
    10.67538126361655,
    10.893246187363827,
    11.111111111111104,
    11.32897603485838,
    11.546840958605657,
    11.764705882352933,
    11.98257080610021,
    12.200435729847486,
    12.418300653594763,
    12.63616557734204,
    12.854030501089316,
    13.071895424836592,
    13.289760348583869,
    13.507625272331145,
    13.725490196078422,
    13.943355119825698,
    14.161220043572975,
    14.379084967320251,
    14.596949891067528,
    14.814814814814804,
    15.03267973856208,
    15.250544662309357,
    15.468409586056634,
    15.68627450980391,
    15.904139433551187,
    16.122004357298465,
    16.339869281045743,
    16.55773420479302,
    16.7755991285403,
    16.993464052287578,
    17.211328976034856,
    17.429193899782135,
    17.647058823529413,
    17.86492374727669,
    18.08278867102397,
    18.300653594771248,
    18.518518518518526,
    18.736383442265804,
    18.954248366013083,
    19.17211328976036,
    19.38997821350764,
    19.607843137254918,
    19.825708061002196,
    20.043572984749474,
    20.261437908496752,
    20.47930283224403,
    20.69716775599131,
    20.915032679738587,
    21.132897603485866,
    21.350762527233144,
]
pos_2_power = [
    0.006284120242329552,
    0.014125066193755292,
    0.01012275601495977,
    0.0054479858898157174,
    0.008769370597791733,
    0.003155239641252993,
    0.00905110718011159,
    6.22903879003141E-4,
    0.01895379833425173,
    0.01981503032890901,
    0.012102121652149116,
    0.03019645781435156,
    0.23584264305987127,
    1.7668077200719674,
    1.971402630524318,
    0.23666989808954944,
    0.07388690932479806,
    0.029953696696633933,
    0.03544736832482914,
    0.016957097538302116,
    0.018282378770570266,
    0.014737757352911674,
    0.01136468198524983,
    0.00919000765470551,
    0.008955099881930127,
    0.0037157886468017626,
    0.006343632561460869,
    0.005540549398103886,
    0.005071618412837915,
    0.0038467871966236574,
    0.003369503584754495,
    0.004348656571581184,
    0.0027578565217709575,
    0.00264629107608223,
    0.0023070425944597874,
    0.003187397507350666,
    0.001086418588799885,
    0.0017319767216507822,
    0.0016295946625202403,
    0.00128267706199616,
    5.313161049720675E-4,
    0.004946851645703427,
    5.306820258059659E-4,
    0.0013655678103924951,
    0.00322244638011923,
    0.0016568163806980653,
    0.001106475772219953,
    7.503291772044296E-4,
    9.593323134095157E-4,
    0.0024257862034197516,
    3.11283806643834E-4,
    0.0012947243557800458,
    7.316502220871572E-4,
    3.809447003526548E-4,
    0.0010781177946770641,
    4.2121991903901993E-4,
    0.001537982042555163,
    7.021272638247472E-4,
    0.0012774892542110452,
    9.99856725059371E-4,
    7.251999984466507E-4,
    8.140823413632362E-4,
    7.071024543852441E-4,
    4.8594188933614036E-4,
    2.460099045161977E-4,
    8.836034716662676E-4,
    0.0017278371254072287,
    0.0016756418755074164,
    2.39586405253189E-4,
    6.089668649467038E-4,
    0.0016631177732024762,
    0.0014012462808073562,
    3.767783323518396E-4,
    2.3085556898874116E-4,
    6.630681915430586E-4,
    5.70968824182832E-4,
    7.633962953174981E-5,
    4.4013521282414034E-4,
    2.2427445084196852E-4,
    4.3999553974985884E-4,
    1.2805517760894558E-4,
    2.2318028481275903E-4,
    1.7265961067642504E-4,
    7.390444817762141E-4,
    4.230680685125483E-4,
    4.876236608933319E-4,
    8.001082957232865E-4,
    4.023597247400165E-4,
    7.150077747757917E-4,
    7.568570065261363E-4,
    4.596898152172547E-4,
    6.135342219996572E-4,
    1.1150454685175975E-4,
    2.913108865930616E-4,
    3.0002841600298416E-4,
    5.855382679413928E-4,
    0.001274655039412658,
    2.3387602248449153E-4
]


def fp(f, p):
    a = (f * p)
    return a


# Observed Values
weight_single_numerator = list(map(fp, single_f, single_power))
weight_single = round(sum(weight_single_numerator) / sum(single_power), 3)
weight_single_angular = round(weight_single * 2 * np.pi, 3)

print("Single Oscillator Statistics")
print("The weighted average frequency of the single oscillator is", weight_single, "Hz")
print("Therefore the weighted average angular frequency is", weight_single_angular, "rad/s")

weight_coupled_numerator = list(map(fp, coupled_f, coupled_power))
weight_coupled = round(sum(weight_coupled_numerator) / sum(coupled_power), 3)
weight_coupled_angular = round(weight_coupled * 2 * np.pi, 3)

print()
print("Coupled Oscillator Statistics")
print("The weighted average frequency of the coupled oscillator is", weight_coupled, "Hz")
print("Therefore the weighted average angular frequency is", weight_coupled_angular, "rad/s")

weight_neg_1_numerator = list(map(fp, neg_1_f, neg_1_power))
weight_neg_1 = round(sum(weight_neg_1_numerator) / sum(neg_1_power), 3)
weight_neg_1_angular = round(weight_neg_1 * 2 * np.pi, 3)

print()
print("Omega Minus 1st Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 1st mass is", weight_neg_1, "Hz")
print("Therefore the weighted average angular frequency is", weight_neg_1_angular, "rad/s")

weight_neg_2_numerator = list(map(fp, neg_2_f, neg_2_power))
weight_neg_2 = round(sum(weight_neg_2_numerator) / sum(neg_2_power), 3)
weight_neg_2_angular = round(weight_neg_2 * 2 * np.pi, 3)

print()
print("Omega Minus 2nd Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 2nd mass is", weight_neg_2, "Hz")
print("Therefore the weighted average angular frequency is", weight_neg_2_angular, "rad/s")

weight_pos_1_numerator = list(map(fp, pos_1_f, pos_1_power))
weight_pos_1 = round(sum(weight_pos_1_numerator) / sum(pos_1_power), 3)
weight_pos_1_angular = round(weight_pos_1 * 2 * np.pi, 3)

print()
print("Omega Plus 1st Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 1st mass is", weight_pos_1, "Hz")
print("Therefore the weighted average angular frequency is", weight_pos_1_angular, "rad/s")

weight_pos_2_numerator = list(map(fp, pos_2_f, pos_2_power))
weight_pos_2 = round(sum(weight_pos_2_numerator) / sum(pos_2_power), 3)
weight_pos_2_angular = round(weight_pos_2 * 2 * np.pi, 3)

print()
print("Omega Plus 2nd Mass Statistics")
print("The weighted average frequency of the driven coupled oscillator's 2nd mass is", weight_pos_2, "Hz")
print("Therefore the weighted average angular frequency is", weight_pos_2_angular, "rad/s")

# Expected Values
k1 = 23.98
k2 = 17.36
m1 = 0.131
m2 = 0.108
wplus = (1 / np.sqrt(2)) * np.sqrt(
    (k2 / m2) + (k1 + k2) / m1 + np.sqrt((k2 / m2 + (k1 + k2) / m1) ** 2 - 4*(k2 * (k1 + k2) - k2 ** 2) / (m1 * m2)))

wminus = (1 / np.sqrt(2)) * np.sqrt(
    (k2 / m2) + (k1 + k2) / m1 - np.sqrt((k2 / m2 + (k1 + k2) / m1) ** 2 - 4*(k2 * (k1 + k2) - k2 ** 2) / (m1 * m2)))

print()
print("The theoretical angular frequencies of the coupled oscillator are", round(wplus, 3), "rad/s and",
      round(wminus, 3), "rad/s")
